From 672ab37bb2f8f821cb8f63d59f1a19f7e389296b Mon Sep 17 00:00:00 2001
From: Konstantin Khlebnikov <khlebnikov@openvz.org>
Date: Tue, 10 Mar 2009 14:27:17 +0300
Subject: [PATCH] pidns: lost task debug print uses wrong prototype

Print most interesting fields manually.

http://bugzilla.openvz.org/show_bug.cgi?id=1181

Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org>
Signed-off-by: Pavel Emelyanov <xemul@openvz.org>
---
 kernel/pid_namespace.c |   11 ++++-------
 1 files changed, 4 insertions(+), 7 deletions(-)

diff --git a/kernel/pid_namespace.c b/kernel/pid_namespace.c
index 1445b22..4aee3b9 100644
--- a/kernel/pid_namespace.c
+++ b/kernel/pid_namespace.c
@@ -250,13 +250,10 @@ EXPORT_SYMBOL_GPL(pid_ns_attach_init);
 #ifdef CONFIG_VE
 static noinline void show_lost_task(struct task_struct *p)
 {
-	char buf[512] = "N/A";
-#ifdef CONFIG_PROC_FS
-	extern char * task_sig(struct task_struct *p, char *buffer);
-
-	task_sig(p, buf);
-#endif
-	printk("Lost task: %d/%s/%p\nSignals:%s\n", p->pid, p->comm, p, buf);
+	printk("Lost task: %d/%s/%p blocked: %lx pending: %lx\n",
+			p->pid, p->comm, p,
+			p->blocked.sig[0],
+			p->pending.signal.sig[0]);
 }
 
 static void zap_ve_processes(struct ve_struct *env)
-- 
1.6.2

