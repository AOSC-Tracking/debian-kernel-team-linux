From 134416f49ad04db56afd7eb2a41ddef4f157ea6f Mon Sep 17 00:00:00 2001
From: Konstantin Khlebnikov <khlebnikov@openvz.org>
Date: Fri, 14 Nov 2008 19:19:40 +0300
Subject: [PATCH] Correct per-process capabilities bounding set in CT

Otherwise tasks in container may have unlimited capabilities...

(#127136)

Singed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org>
Signed-off-by: Pavel Emelyanov <xemul@openvz.org>
---
 kernel/ve/vecalls.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/kernel/ve/vecalls.c b/kernel/ve/vecalls.c
index 55d8b7b..4a4a24b 100644
--- a/kernel/ve/vecalls.c
+++ b/kernel/ve/vecalls.c
@@ -869,6 +869,7 @@ static void set_task_ve_caps(struct task_struct *tsk, struct ve_struct *ve)
 	tsk->cap_effective = cap_intersect(tsk->cap_effective, bset);
 	tsk->cap_inheritable = cap_intersect(tsk->cap_inheritable, bset);
 	tsk->cap_permitted = cap_intersect(tsk->cap_permitted, bset);
+	tsk->cap_bset = cap_intersect(tsk->cap_bset, bset);
 	spin_unlock(&task_capability_lock);
 }
 
-- 
1.6.0.6

